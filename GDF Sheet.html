<input type="hidden" class="sheet-tabstoggle" name="attr_sheetTab"  value="display"  />
<div>
    <button type="action" name="act_input" >Input</button>
    <button type="action" name="act_display" >Display</button>
    <button type="action" name="act_abilities" >Special Rules</button>
</div>

<div class="sheet-input">
    <div class="2colrow">
        <div class="col">
            <h3>Unit Information</h3>
            <label>Name:</label><input type="text" name="attr_character_name">
            <br>
            <label for="attr_faction">Faction:</label>
            <select name="attr_faction">
                <option value="" selected disabled hidden>Choose here</option>
                <option value="Ultramarines">Ultramarines</option>
                <option value="Blood Angels">Blood Angels</option>
                <option value="Deathguard">Deathguard</option>
                <option value="Tau">Tau</option>
                <option value="Imperial Guard">Imperial Guard</option>


            </select>
        </div>
        <div class="col">
            <h3>Attributes</h3>
            <label>Quality:</label><input type="number" name="attr_quality">
            <label>Defense:</label><input type="number" name="attr_defense">
            <label>Toughness:</label><input type="number" name="attr_toughness">
            <label for="attr_type">Type:</label>
            <select name="attr_type">
                <option value="" selected disabled hidden>Choose here</option>
                <option value="Infantry">Infantry</option>
                <option value="Hero">Hero</option>
                <option value="Vehicle">Vehicle</option>
                <option value="Monster">Monster</option>
                <option value="Aircraft">Aircraft</option>
            </select>        
          </div>
    </div>    

    <label>Special Rules:</label><input type="text" name="attr_special">
    <label>Upgrades:</label><input type="text" name="attr_upgrades">
    <label for="attr_rank">Rank/Priority:</label>
    <select name="attr_rank">
        <option value="" selected disabled hidden>Choose here</option>
        <option value=1>Base</option>
        <option value=2>Weapons</option>
        <option value=3>Heavy Weapons</option>
        <option value=4>Sergeant</option>
        <option value=5>Hero</option>
    </select>  

    <div class="row">
        <h3>Weapons</h3>

    <div class="weapons">
        <table>
          <thead>
            <tr>
              <th>Weapon</th>
              <th>Type</th>
              <th>Range</th>
              <th>Attack</th>
              <th>AP</th>
              <th>Special</th>
              <th>F/X</th>
              <th>Sound</th>
            </tr>
          </thead>
          <tbody>
            <tr>
                <td><input type="text" name="attr_weapon1name"></td>
                <select name="attr_weapon1type">
                    <option value="" selected disabled hidden>Choose here</option>
                    <option value="Rifle">Rifle</option>
                    <option value="CCW">CCW</option>
                    <option value="Heavy">Heavy</option>
                    <option value="Sniper">Heavy</option>
                    <option value="Pistol">Pistol</option>
                    <option value="Mod">Mod</option>
                </select></td>      
                <td><input type="text" name="attr_weapon1range"></td>
                <td><input type="number" name="attr_weapon1attack"></td>
                <td><input type="number" name="attr_weapon1ap"></td>
                <td><input type="text" name="attr_weapon1special"></td>
                <td><input type="text" name="attr_weapon1fx"></td>
                <td><input type="text" name="attr_weapon1sound"></td>                
            </tr>
            <tr>
                <td><input type="text" name="attr_weapon2name"></td>
                <select name="attr_weapon2type">
                    <option value="" selected disabled hidden>Choose here</option>
                    <option value="Rifle">Rifle</option>
                    <option value="CCW">CCW</option>
                    <option value="Heavy">Heavy</option>
                    <option value="Sniper">Heavy</option>
                    <option value="Pistol">Pistol</option>
                    <option value="Mod">Mod</option>
                </select></td>  
                <td><input type="text" name="attr_weapon2range"></td>
                <td><input type="number" name="attr_weapon2attack"></td>
                <td><input type="number" name="attr_weapon2ap"></td>
                <td><input type="text" name="attr_weapon2special"></td>
                <td><input type="text" name="attr_weapon2fx"></td>
                <td><input type="text" name="attr_weapon2sound"></td>    
            </tr>
            <tr>
                <td><input type="text" name="attr_weapon3name"></td>
                <select name="attr_weapon3type">
                    <option value="" selected disabled hidden>Choose here</option>
                    <option value="Rifle">Rifle</option>
                    <option value="CCW">CCW</option>
                    <option value="Heavy">Heavy</option>
                    <option value="Sniper">Heavy</option>
                    <option value="Pistol">Pistol</option>
                    <option value="Mod">Mod</option>
                </select></td>  
                <td><input type="text" name="attr_weapon3range"></td>
                <td><input type="number" name="attr_weapon3attack"></td>
                <td><input type="number" name="attr_weapon3ap"></td>
                <td><input type="text" name="attr_weapon3special"></td>
                <td><input type="text" name="attr_weapon3fx"></td>
                <td><input type="text" name="attr_weapon3sound"></td>    
            </tr>
            <tr>
                <td><input type="text" name="attr_weapon4name"></td>
                <select name="attr_weapon4type">
                    <option value="" selected disabled hidden>Choose here</option>
                    <option value="Rifle">Rifle</option>
                    <option value="CCW">CCW</option>
                    <option value="Heavy">Heavy</option>
                    <option value="Sniper">Heavy</option>
                    <option value="Pistol">Pistol</option>
                    <option value="Mod">Mod</option>
                </select></td>  
                <td><input type="text" name="attr_weapon4range"></td>
                <td><input type="number" name="attr_weapon4attack"></td>
                <td><input type="number" name="attr_weapon4ap"></td>
                <td><input type="text" name="attr_weapon4special"></td>
                <td><input type="text" name="attr_weapon4fx"></td>
                <td><input type="text" name="attr_weapon4sound"></td>    
            </tr>
            <tr>
                <td><input type="text" name="attr_weapon5name"></td>
                <td><label for="attr_weapon5type">Type:</label>
                <select name="attr_weapon5type">
                    <option value="" selected disabled hidden>Choose here</option>
                    <option value="Rifle">Rifle</option>
                    <option value="CCW">CCW</option>
                    <option value="Heavy">Heavy</option>
                    <option value="Sniper">Heavy</option>
                    <option value="Pistol">Pistol</option>
                    <option value="Mod">Mod</option>
                </select></td>  
                <td><input type="text" name="attr_weapon5range"></td>
                <td><input type="number" name="attr_weapon5attack"></td>
                <td><input type="number" name="attr_weapon5ap"></td>
                <td><input type="text" name="attr_weapon5special"></td>
                <td><input type="text" name="attr_weapon5fx"></td>
                <td><input type="text" name="attr_weapon5sound"></td>    
            </tr>
          </tbody>
        </table>    
     </div>    

    </div>    


</div>



<div class="sheet-display">
    <input type="hidden" name="attr_faction"/>

    <div class="mysheet">
      <div class="attributes">

        <main>
        <input type="hidden" name="attr_faction"/>
          <section class="header f-center">
            <h1><span name="attr_character_name"></span></h1>
            <h3><span name="attr_faction"></span> <span name="attr_type"></span></h3>
          </section>

          <section class="common f-center">
              <img alt="Character Avatar" name="attr_character_avatar"/>
          </section>

          <section class="att">
            <h3>Attributes</h3>
            <div class="attinfo">
                <div><span>Quality</span></div>
                <div><span>Defense</span></div>
                <div><span>Toughness</span></div>
                <h4><span name="attr_quality"></span><span>+</span></h4>
                <h4><span name="attr_defense"></span><span>+</span></h4>
                <h4><span name="attr_toughness"></span></h4>
          </section>

          <section class="flag">
            <img name="attr_factionImage">
          </section>
          
          <section class="flag2">
            <img name="attr_factionImage">
          </section>

          <section class="special">
            <h3>Special Rules</h3>
            <h4><span name="attr_special0"></span></h4>
            <h4><span name="attr_special1"></span></h4>
            <h4><span name="attr_special2"></span></h4>
            <h4><span name="attr_special3"></span></h4>
            <h4><span name="attr_special4"></span></h4>
          </section>

          <section class="upgrades">
            <h3>Upgrades</h3>
            <h4><span name="attr_upgrade0"></span></h4>
            <h4><span name="attr_upgrade1"></span></h4>
            <h4><span name="attr_upgrade2"></span></h4>
            <h4><span name="attr_upgrade3"></span></h4>
            <h4><span name="attr_upgrade4"></span></h4>
          </section>



          <section class="weapon">
            <h3>Weapons</h3>
            <div class="weaponinfo">
                <div><span>Weapon</span></div>
                <div><span>Type</span></div>
                <div><span>Range</span></div>
                <div><span>Attack</span></div>
                <div><span>AP</span></div>
                <div><span>Special</span></div>

                <h4><span name="attr_weapon1name"></span></h4>
                <h4><span name="attr_weapon1type"></span></h4>
                <h4><span name="attr_weapon1range"></span></h4>
                <h4><span name="attr_weapon1attack"></span></h4>
                <h4><span name="attr_weapon1ap"></span></h4>
                <h4><span name="attr_weapon1special"></span></h4>

                <h4><span name="attr_weapon2name"></span></h4>
                <h4><span name="attr_weapon2type"></span></h4>
                <h4><span name="attr_weapon2range"></span></h4>
                <h4><span name="attr_weapon2attack"></span></h4>
                <h4><span name="attr_weapon2ap"></span></h4>
                <h4><span name="attr_weapon2special"></span></h4>

                <h4><span name="attr_weapon3name"></span></h4>
                <h4><span name="attr_weapon3type"></span></h4>
                <h4><span name="attr_weapon3range"></span></h4>
                <h4><span name="attr_weapon3attack"></span></h4>
                <h4><span name="attr_weapon3ap"></span></h4>
                <h4><span name="attr_weapon3special"></span></h4>

                <h4><span name="attr_weapon4name"></span></h4>
                <h4><span name="attr_weapon4type"></span></h4>
                <h4><span name="attr_weapon4range"></span></h4>
                <h4><span name="attr_weapon4attack"></span></h4>
                <h4><span name="attr_weapon4ap"></span></h4>
                <h4><span name="attr_weapon4special"></span></h4>

                <h4><span name="attr_weapon5name"></span></h4>
                <h4><span name="attr_weapon5type"></span></h4>
                <h4><span name="attr_weapon5range"></span></h4>
                <h4><span name="attr_weapon5attack"></span></h4>
                <h4><span name="attr_weapon5ap"></span></h4>
                <h4><span name="attr_weapon5special"></span></h4>
            </div>         
          </section>
        </main>
      </div>
    </div>    
</div>

<div class="sheet-abilities">
  <input type="hidden" name="attr_faction"/>
  <div class="mysheet">
      <div class="attributes">
          <input type="hidden" name="attr_faction"/>
          <div class="spheader">
              <h2>Special Rules</h2>
              <br>
          </div>
          <input type="hidden" name="attr_faction"/>
          <div class="spbody">
              <div class = "item">
                  <span style="font-weight:bold;" name="attr_spec1Name"></span>
                  <span name="attr_spec1Text"></span>
              </div>
              <div class = "item">
                  <span style="font-weight:bold;" name="attr_spec2Name"></span>
                  <span name="attr_spec2Text"></span>
              </div>
              <div class = "item">
                  <span style="font-weight:bold;" name="attr_spec3Name"></span>
                  <span name="attr_spec3Text"></span>
              </div>
              <div class = "item">                
                  <span style="font-weight:bold;" name="attr_spec4Name"></span>
                  <span name="attr_spec4Text"></span>
              </div>
              <div class = "item">                                
                  <span style="font-weight:bold;" name="attr_spec5Name"></span>
                  <span name="attr_spec5Text"></span>
              </div>
              <div class = "item">                
                  <span style="font-weight:bold;" name="attr_spec6Name"></span>
                  <span name="attr_spec6Text"></span>
              </div>
              <div class = "item">                
                  <span style="font-weight:bold;" name="attr_spec7Name"></span>
                  <span name="attr_spec7Text"></span>
              </div>
              <div class = "item">                
                  <span style="font-weight:bold;" name="attr_spec8Name"></span>
                  <span name="attr_spec8Text"></span>
              </div>
              <div class = "item">                
                  <span style="font-weight:bold;" name="attr_spec9Name"></span>
                  <span name="attr_spec9Text"></span>
              </div>
              <div class = "item">                
                  <span style="font-weight:bold;" name="attr_spec10Name"></span>
                  <span name="attr_spec10Text"></span>
              </div>
          </div>
      </div>
  </div>
</div>


<script type="text/worker">
    const buttonlist = ["input","display","abilities"];
    buttonlist.forEach(button => {
        on(`clicked:${button}`, function() {
            setAttrs({
                sheetTab: button
            });
        });
    });

    on("sheet:opened", function() {
        setAttrs({sheetTab:"display"});
    });

    on("change:attrs sheet:opened", function() { 
        getAttrs(["faction","special","upgrades"], function(values) {
            let faction = values.faction;
            let factionImage = "";

            let special = values.special;
            special = special.split(";");

            let upgrades = values.upgrades;
            upgrades = upgrades.split(";");

            if (faction === "Ultramarines") {
                factionImage = "https://s3.amazonaws.com/files.d20.io/images/353049529/KtPvktw8dgMFRyHJIW-i6w/thumb.png?1690989195";
            }
            if (faction === "Blood Angels") {
              factionImage = "https://s3.amazonaws.com/files.d20.io/images/354261572/BMAsmC28Ap91qYIfra71yw/thumb.png?1691796541";
            }
            if (faction === "Deathguard") {
                factionImage = "https://s3.amazonaws.com/files.d20.io/images/353239057/GIITPAhD-JdRRD2D6BREWw/thumb.png?1691112406";
            }
            if (faction === "Tau") {
                factionImage = "https://s3.amazonaws.com/files.d20.io/images/354348305/k_izI31oM8lRsHHma1xfag/thumb.png?1691855991";
            }      
            if (faction === "Imperial Guard") {
                factionImage = "https://s3.amazonaws.com/files.d20.io/images/354557308/CrRWn51EJHMtijUM1wqB-g/thumb.webp?1691958030";
            }    


            setAttrs({
                "factionImage": factionImage,
                "special0": special[0],
                "special1": special[1],
                "special2": special[2],
                "special3": special[3],
                "special4": special[4],
                "upgrade0": upgrades[0],
                "upgrade1": upgrades[1],
                "upgrade2": upgrades[2],
                "upgrade3": upgrades[3],
                "upgrade4": upgrades[4],
            });
        });    
    });  

</script>